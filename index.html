<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Sample Presentation Repository by UniSalento-IDALab-IoTCourse-2022-2023</title>
    <link rel="stylesheet" href="css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header style="background-color: #125DFF">
        <h1 style="color: #FFEF6F">Repository di presentazione del progetto "Smart Headphones for Safety"</h1>
        <p></p>
      </header>

      <style>
        #banner {
          background-color: #9FDBFC;
          border-color: #4276b6;
        }
      </style>
      <div id="banner" >
        <span id="logo"></span>


        <a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-presentation-RolloCotardo" class="button fork"><strong>View the code of this page on GitHub</strong></a>



      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul>
          <li class="tag-h2 active">
            <a href="#nome-del-progetto-e-repository-github">Nome del progetto e repository github</a>
          </li>
          <li class="tag-h2">
            <a href="#membri-del-team">Membri del team</a>
          </li>
          <li class="tag-h2">
            <a href="#presentazione-concept">Presentazione del concept</a>
          </li>
          <li class="tag-h2">
            <a href="#funzionalita-e-architettura">Funzionalità e architettura</a>
          </li>
          <li class="tag-h2">
            <a href="#istruzioni">Istruzioni per far funzionare il prototipo</a>
          </li>
        </ul>
      </nav>
      <section style="height: auto; width: fit-content">
        <div class="subsection">
          <span class="anchor" id="nome-del-progetto-e-repository-github"></span>
          <h2 >Nome del progetto e repository github</h2>

          <h3>Nome del progetto: Smart Headphones for Safety</h3>
          <p>Repository del sito di presentazione progetto: <a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-presentation-RolloCotardo">https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-presentation-RolloCotardo</a></p>
          <p>Tutti i Repository del prototipo (codice):
            <ul>
              <li><a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-AndroidApplication-RolloCotardo">Applicazione Android</a></li>
              <li><a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-raspberryS-RolloCotardo">Simulazione Sega a nastro</a></li>
              <li><a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-raspberryT-RolloCotardo">Simulazione Tornio</a></li>
              <li><a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-backend-RolloCotardo">Backend</a></li>
              <li><a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023/wot-project-2022-2023-Frontend-RolloCotardo">Frontend</a></li>
        </ul>
          </p>


        </div>
        <div class="subsection">
          <span class="anchor" id="membri-del-team"></span>
          <h2>Membri del team</h2>

          <table>
            <thead>
              <tr>
                <th style="text-align: center">Matricola</th>
                <th style="text-align: center">Cognome</th>
                <th style="text-align: center">Nome</th>
                <th style="text-align: center">E-mail</th>
                <th style="text-align: center">GitHub</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align: center">20080995</td>
                <td style="text-align: center">Cotardo</td>
                <td style="text-align: center">Mattia</td>
                <td style="text-align: center">mattia.cotardo@studenti.unisalento.it</td>
                <td style="text-align: center">
                  <a href="https://github.com/MattiaCotardo">Mattia Cotardo</a>
                </td>              </tr>
              <tr>
                <td style="text-align: center">20086483</td>
                <td style="text-align: center">Rollo</td>
                <td style="text-align: center">Davide</td>
                <td style="text-align: center">davide.rollo1@studenti.unisalento.it</td>
                <td style="text-align: center">
                  <a href="https://github.com/MattiaCotardo">Davide Rollo</a>
                </td>
              </tr>
            </tbody>
          </table>


        </div>
        <div class="subsection">
          <span class="anchor" id="presentazione-concept"></span>
          <h2>Presentazione del progetto</h2>

          <p>
            Questa è la pagina web al progetto "Smart Headphones for Safety", ossia un progetto dell'Università del Salento del
            corso di Internet of Thing nato per tutelare la sicurezza di lavoratori in ambienti di lavoro rumorosi. Sono infatti numerosissimi i
            casi di operatori che subiscono danni permanenti all'udito a causa di una mancata protezione del loro apparato uditivo, in fabbriche e
            industrie rumorose. In questo progetto si è sviluppato un sistema di cuffie smart che non solo permettono all'operatore di isolarsi dai rumori esterni,
            ma grazie all'impiego di una applicazione Android permettono anche la ricezione di notifiche di allarme da parte di macchinari potenzialmente
            pericolosi, venendo quindi avvertiti in tempo e potendo quindi allontanarsi a una distanza di sicurezza dal pericolo. Il vantaggio di un progetto di
            questo tipo è che non solo permette un isolamento dai rumori esterni, ma evita anche quelle complicazioni dovute a un isolamento completo, come operatori
            che non si accorgono di essere troppo vicini ai macchinari, che possono quindi incorrere in danni fisici anche permanenti nei peggiori dei casi.
          </p>


        </div>
        <div class="subsection">
          <span class="anchor" id="funzionalita-e-architettura"></span>
          <h2>Funzionalità e architettura</h2>

          <span class="anchor" id="funzionalita-complete-del-social-network"></span>
          <h3>Funzionalità complete del progetto</h3>

          <table>
            <thead>
              <tr>
                <th style="text-align: center">Funzionalità complete</th>
                <th style="text-align: center">Descrizione</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align: center">
                  <strong>Generazione dati macchinari</strong>
                </td>

                <td style="text: center">Il progetto è in grado di simulare il comportamento di due macchinari
                tipici dell'industria del legno: una sega a nastro e un tornio. Si riesce a fare questo tramite
                due codici python che generano pseudorandomicamente i dati associati ai macchinari. Il codice che simula
                la sega a nastro genera i seguenti 6 valori:
                  <ul>
                    <li>Tensione della lama</li>
                    <li>Allineamento della lama</li>
                    <li>Velocità avanzamento della lama</li>
                    <li>Velocità rotazione della lama</li>
                    <li>Livello di lubrificante</li>
                    <li>Potenza del macchinario</li>

                  </ul>
                  Mentre il codice che simula il tornio genera i seguenti 5 valori:
                  <ul>
                    <li>Allineamento del tornio</li>
                    <li>Vibrazioni del tornio</li>
                    <li>Velocità rotazione tornio</li>
                    <li>Livello di lubrificante</li>
                    <li>Potenza del macchinario</li>

                  </ul>
                </td>

              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Invio dati tramite Modbus</strong>
                </td>
                <td style="text: center">Il progetto non solo è in grado di generare dati,
                ma anche di trasmetterli dalla sede dove sono stati generati a un receiver (un codice python). La trasmissione
                avviene sfruttando Modbus, ossia un protocollo di comunicazione che rappresenta uno standard de facto nelle
                comunicazioni di tipo industriale. Gli 11 dati precedentemente elencati vengono trasmessi usando gli
                holding registers che Modbus mette a disposizione, ossia dei registri in cui è permessa sia la lettura che
                la scrittura</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Controllo e generazione allarmi</strong>
                </td>
                <td style="text: center">Una volta ottenuti i dati tramite Modbus, il backend si occupa di effettuare dei controlli
                di sicurezza su questi dati, controllando quali siano fuori range e quali effettivamente siano nel corretto
                intervallo. Nel caso di dati fuori range verrà generato un allarme</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Invio allarmi con MQTT</strong>
                </td>
                <td style="text: center">Una volta generati gli allarmi il sistema è in grado di comprendere quali sono gli allarmi
                relativi alla sega e quali sono quelli relativi al tornio, generando quindi delle notifiche MQTT con dei topic associati.
                Queste notifiche verranno inviate a un broker presente in locale che sarà in grado di smistare i messaggi verso i
                subscriber corretti</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Aggiunta dati al repository</strong>
                </td>
                <td style="text: center">Il backend in python è inoltre in grado di mandare quesi dati e questi allarmi
                  a una applicazione in Springboot (sempre presente in locale) che aggiunge i dati a delle repository Mongo, organizzandoli
                  in 5 collezioni differenti</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Subscribing dinamico</strong>
                </td>
                <td style="text: center">Per il progetto è stata definita una applicazione android in grado di scannerizzare ciclicamente
                l'area circostante e identificare gli indirizzi MAC dei beacon bluetooth associati ai due macchinari. Quando il valore dell'RSSI di un beacon
                si fa troppo grande, l'applicazione effettua un subscribing dinamico al topic associato al macchinario di quel beacon (i topic sono
                  "allarme/sega/1" per il macchinario sega e "allarme/tornio/1" per il macchinario tornio), in questo modo
                  l'applicazione sarà in grado di ricevere eventuali notifiche di allarme mandate dal backend ed associate a quel topic.
                  Allo stesso modo, quando il valore dell'rssi si fa troppo piccolo o scompare del tutto, viene effettuata una cancellazione dinamica
                da quel topic. Tramite questo modo si è in grado di tenere traccia di quale lavoratore si trovi vicino a quale macchinario, e mandare le notifiche
                di allarme in maniera intelligente e mirata ai vari operatori</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Lettura delle notifiche</strong>
                </td>
                <td style="text: center">L'applicazione Android è inoltre in grado, una volta ricevuta una notifica di allarme, di leggerla tramite un sintetizzatore
                vocale. Gli operatori, che staranno indossando delle cuffie bluetooth isolanti, a causa dei forti rumori prodotti dai macchinari, riusciranno a sentire
                distintamente la notifica e potranno quindi posizionarsi a una distanza di sicurezza dal macchinario</td>
              </tr>
              <tr>
                <td style="text-align: center">
                  <strong>Visualizzazione dati tramite dashboard</strong>
                </td>
                <td style="text: center">L'ultima funzionalità del progetto è mettere a disposizione una dashboard in Angular che permette a un amministratore
                che abbia effettuato l'accesso, la visualizzazione di dati e allarmi in tempo reale, sia tramite visualizzazione testuale che tramite visualizzazione grafica.
                </td>
              </tr>

            </tbody>
          </table>


          <span class="anchor" id="architettura-dellinformazione"></span>
          <h3>Architettura del sistema</h3>

          <img src="images/diagram1.png" alt="Immagine dell'architettura software">

        </div>

        <div class="subsection">
          <span class="anchor" id="istruzioni"></span>
          <h2>Istruzioni per far funzionare il prototipo</h2>
            <h3>1 - Avvio del broker MQTT </h3>
              <p>Il primo passaggio necessario è avviare il broker MQTT.</p>
              <p>Per fare ciò è necessario avere Mosquitto installato sul proprio PC e lanciare i seguenti comandi:</p>
              <p style="font-family: monospace"> > net start mosquitto</p>
              <p style="font-family: monospace"> > cd “C:\Program Files\mosquitto” </p>
              <p style="font-family: monospace"> > .\mosquitto -v -c testconfig.txt </p>
              <p> dove testconfig.txt è un file da dover creare che possiede il seguente contenuto:</p>
              <p style="font-family: monospace"> listener 1883</p>
              <p style="font-family: monospace"> allow_anonymous true</p>
            <h3>2 - Avvio dei macchinari </h3>
              <p>Adesso è necessario avviare i codici python che simulano il comportamento dei macchinari</p>
              <p>Prima di tutto è necessario modificare all'interno dei codici l'IP del receiver Modbus, ossia l'IP
                della macchina su cui il backend sarà in esecuzione (ad esempio il proprio PC)</p>
              <p>Una volta completate le modifiche è necessario portare i due python sui due Raspberry e avviare ogni codice
              tramite i seguenti comandi: </p>
              <p style="font-family: monospace"> > python mainSega.py </p>
              <p> Sul Raspberry col codice che simula la sega a nastro </p>
              <p style="font-family: monospace"> > python mainTornio.py </p>
              <p> Sul Raspberry col codice che simula il tornio </p>
          <h3>3 - Avvio del Backend (Springboot e Mongo)  </h3>
              <p>Ora è necessario avviare i container Springboot e Mongo</p>
              <p>Per fare ciò è necessario avere Docker installato sul proprio PC, spostarsi nella cartella dove c'è il file
                docker-compose.yml e lanciare il seguente comando:</p>
              <p style="font-family: monospace"> > docker compose up </p>
          <h3>4 - Avvio del Backend (Python)  </h3>
              <p>Ora è necessario avviare la componente Python del Backend</p>
              <p>Per fare ciò è sufficiente aprire il codice e cambiare l'IP del broker MQTT con quello corretto,
                poi spostarsi nella cartella del main e lanciare il seguente comando:</p>
              <p style="font-family: monospace"> > python main.py </p>
              <p>Nel caso l'avvio non dovesse andare a buon fine potrebbe essere necessario installare le librerie utilizzate nel codice:</p>
              <p style="font-family: monospace"> > pip install pyModbusTCP </p>
              <p style="font-family: monospace"> > pip install requests </p>
              <p style="font-family: monospace"> > pip install paho-mqtt </p>
          <h3>5 - Avvio dell'applicazione Android  </h3>
              <p>Ora che l'intero sistema è up è il momento di avviare l'applicazione android installata sul proprio cellulare, la quale
              entrerà automaticamente in funzione. </p>
              <p>Se non si ha l'applicazione installata è necessario aprire Android Studio e generare l'apk dell'applicazione, ma prima
              è importante cambiare l'ip del broker MQTT don quello corretto.</p>
          <h3>6 - Avvio del frontend e accesso alla dashboard  </h3>
              <p>Ora è possibile sfruttare anche le funzionalità della dashboard</p>
              <p>Per fare questo è necessario prima di tutto aggiungere un amministratore al sistema. Per fare ciò è sufficiente aprire PostMan e lanciare la seguente richiesta POST
              in cui vengono inserite le credenziali dell'amministratore del sistema: </p>
              <img src="images/addAdmin.png" alt="Immagine dell'api post">
              <p>Poi è necessario avviare il server Angular lanciando i seguenti comandi: </p>
              <p style="font-family: monospace"> > npm install </p>
              <p style="font-family: monospace"> > ng serve </p>
              <p>Infine sarà sufficiente aprire un qualsiasi browser web e digitare:</p>
              <p style="font-family: monospace"> localhost:4200 </p>
              <p> Ora basterà effettuare l'accesso con le credenziali prima inserite e sarà possibile navigare all'interno della dashboard </p>







        </div>
      </section>
      <footer>

          <p>Project maintained by <a href="https://github.com/UniSalento-IDALab-IoTCourse-2022-2023">UniSalento-IDALab-IoTCourse-2022-2023</a></p>

        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->



  </body>
</html>
